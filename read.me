Deploy TightVNC via GPO (editando MSI com ORCA)
Deploy TightVNC via GPO (editando MSI com ORCA)

Bruno GuerraBruno Guerra
Bruno Guerra
Analista de Redes Sr
Publicado em 23 de mar. de 2021
+ Siga
Caros colegas, preparei esse material para orientar na implanta√ß√£o de um pacote MSI via GPO, al√©m de customizar um pacote MSI com a aplica√ß√£o ORCA. No nosso caso, vamos customizar a instala√ß√£o do TightVNC.

A aplica√ß√£o ORCA est√° dispon√≠vel no Windows 10 SDK

Link: https://developer.microsoft.com/en-us/windows/downloads/windows-10-sdk/ 

Fa√ßa o download da ISO e procure pelo pacote Orca-x86_en-us.msi

Como vamos utilizar o TightVNC, realizamos o download no site do fabricante

https://www.tightvnc.com/download.php 

No alt text provided for this image
  Clique com o bot√£o direito no pacote MSI e escolha a op√ß√£o ‚ÄúEdit With Orca‚Äù

No alt text provided for this image
 

No Menu superior, em Transform, clique na op√ß√£o ‚ÄúNew Transform‚Äù, agora podemos customizar o pacote

No alt text provided for this image
  

No TightVNC, praticamente todas as op√ß√µes que vamos alterar est√£o na tabela Property.  

No alt text provided for this image
No nosso caso, editamos algumas chaves. 

Na tabela Property

SET_USECONTROLAUTHENTICATION 1 

VALUE_OF_USECONTROLAUTHENTICATION = 1 

SET_CONTROLPASSWORD = 1 

SET_USEVNCAUTHENTICATION = 1 

VALUE_OF_USEVNCAUTHENTICATION = 1 

SET_PASSWORD = 1 

SET_GRABTRANSPARENTWINDOWS = 1 

VALUE_OF_GRABTRANSPARENTWINDOWS = 1 

SET_IPACCESSCONTROL = 1 

Na tabela CustomAction (definir a senha que precisar√° ser digitada no VNCViewer para se conectar ao computador do usu√°rio) 

SetDataForControlPasswordsActionSilently = P@ssw0rd 

SetDataForPasswordsActionSilently = P@ssw0rd 

Na tabela Registry (nessa chave podemos filtrar a partir de que rede o t√©cnico poder√° se conectar via VNCViewer e a op√ß√£o de o usu√°rio precisar aceitar a conex√£o, que se d√° pelo ‚Äú:2‚Äù. Como n√£o vamos limitar a rede de origem, deixamos de 0.0.0.0 at√© 255.255.255.255)

VALUE_OF_IPACCESSCONTROL = 0.0.0.0-255.255.255.255:2 

 

Com todas as chaves customizadas, no menu Transform, clique em ‚ÄúGenerate Tranform...‚Äù, um arquivo com extens√£o MST ser√° gerado, ele servir√° como complemento para o MSI, na configura√ß√£o da GPO. 

No alt text provided for this image
  

Os pacotes MSI e MST devem estar acess√≠veis para os computadores do dom√≠nio que v√£o receber a GPO, sendo assim, vamos colocar os arquivos na pasta compartilhada do dom√≠nio. Primeiro, copie os arquivos para uma pasta local do controlador de dom√≠nio. No controlador de dom√≠nio, copie os arquivos para: 

C:\Windows\SYSVOL\domain\scripts\VNC 

Recomendo criar uma pasta dentro de Scripts, para deixar mais organizado. N√£o tente copiar o arquivo diretamente da rede, por exemplo, do seu computador para essa pasta do controlador do dom√≠nio, o mesmo n√£o vai permitir, por seguran√ßa. Ap√≥s copiar, teste o acesso por qualquer computador do dom√≠nio. 

\\contoso.com\SYSVOL\contoso.com\scripts\VNC 

 Abra o Snapin de Group Policy do dom√≠nio para criar a GPO. Escolha a OU apropriada, onde os computadores alvo dessa instala√ß√£o est√£o localizados.  

O caminho √© Computer Configuration > Polices > Software Settings > Software Installation 

No alt text provided for this image
 Uma caixa se abrir√° para que voc√™ aponte o arquivo MSI, escolha o caminho \\contoso.com\SYSVOL\contoso.com\scripts\VNC\pacote.msi 

Na caixa que se abrir√°, escolha a op√ß√£o Advanced 

No alt text provided for this image


No alt text provided for this image
Na aba Modifications, clique em Add e escolha o pacote MST

No alt text provided for this image


Agora basta reiniciar o computador para que a GPO seja aplicada e a instala√ß√£o realizada

No alt text provided for this image
No alt text provided for this image
No alt text provided for this image
 Obs: Algum usu√°rio deve estar logado localmente para que o VNCViewer possa se conectar

 Alguns links de refer√™ncia: 

https://www.tightvnc.com/download.php 

https://www.tightvnc.com/doc/win/TightVNC_2.7_for_Windows_Installing_from_MSI_Packages.pdf 

https://help.hcltechsw.com/domino/11.0.0/admin/inst_usingtransformfilesduringnotesinstallandupgrade_t.html 

https://docs.microsoft.com/pt-br/troubleshoot/windows-server/group-policy/use-group-policy-to-install-software 


15
6 coment√°rios
Tony Douglas Martins Pena
Tony Douglas Martins Pena
Assistente de Infraestrutura PL na Amazon A√ßo

2 sem

N√£o foi fornecido texto alternativo para esta imagem
Gostei
Responder
1  Rea√ß√£o
Tony Douglas Martins Pena
Tony Douglas Martins Pena
Assistente de Infraestrutura PL na Amazon A√ßo

2 sem

cara excelente, me poupou muito trabalho, queria tirar s√≥ uma duvida, espero que possa me ajudar, gostaria de instalar s√≥ o server pois essa GPO √© s√≥ para maquinas de usu√°rios, desde ja agrade√ßo o conteudo disponibilizado. 

Gostei
Responder
1  Rea√ß√£o
Raul Chiarella
Raul Chiarella
Analista de Sistemas | Python | Angular | Docker | DevOps | Back-End

8 m

Estou usando esse seu guia, consigo instalar pelo msiexec mas por algum motivo quando coloco ele na GPO, o software n√£o instala üò• 

Gostei
Responder
Thiago Bruno
Thiago Bruno
Analista de Infraestrutura S√™nior | Tech Leader | DevOps | Linux | Docker | Azure | Apaixonado por tecnologia

2 a

Muito bom

Gostei
Responder
1  Rea√ß√£o
Ver mais coment√°rios

fonte: https://www.linkedin.com/pulse/deploy-tightvnc-via-gpo-editando-msi-com-orca-bruno-guerra/?originalSubdomain=pt
